<html>
<style type="text/css">
        html, body { margin: 0; padding: 0; height: 100%; }
        iframe {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            border: none;
            box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;
        }
    </style>
<body>
<iframe src="https://rakaly.com/loading"></iframe>
<script src="pdxu_rakaly_blob.js"></script>
<script>
    var buffer = createBuffer().buffer;
    var file = new File([buffer], "savegame.eu4", {
        type: "application/octet-stream",
    });

    function postFile() {
        console.log('Posting file ...')
        newWindow.postMessage(file, "*", [buffer]);
        console.log('Posted file!')
        window.close();
    }

    var newWindow = window.open('http://rakaly.com/eu4/analyze')
    window.addEventListener('message', (e) => {
      if (e.data === "rakaly-loaded") {
        postFile();
      }
    });
</script>
</body>
</html>